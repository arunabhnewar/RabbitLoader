var TblCanonical=function(){let t=luxon.DateTime,e=null,s="";function o(e,n){if(!e)return"-";try{let o=t.fromISO(e).setLocale("en").toLocaleString(t.DATETIME_MED);return`<span title="${n} ${o} (${s})">${o}</span>`}catch(e){console.warn(e)}return e}function r(e){return e?Math.round(e*100):"-"}function n(e){return!e||typeof e=="undefined"}function a(){jQuery("head").append(`<style id="rl-canonical-css">.rl_score_tooltip {position: relative;display: inline-block;} .rl_score_tooltip .rl_score_tooltiptext {visibility: hidden;position: absolute; width: 300px; background-color: #555;color: #fff; padding: 5px 10px;border-radius: 6px;z-index: 1;opacity: 0; transition: opacity .6s; font-size: .8125rem;} .rl_score_tooltip-right {top: -5px;left: 150%;}.rl_score_tooltip:hover .rl_score_tooltiptext {visibility: visible; opacity: 1;} .rl_score_tooltip-right::after {content: " "; position: absolute; top: 50%; right: 100%; margin-top: -5px; border-width: 5px; border-style: solid; border-color: transparent #555 transparent transparent;} .rl_score_tooltip-top {bottom: 125%;left: 50%; margin-left: -150px;} .rl_score_tooltip-top::after {content: "";position: absolute;top: 100%;left: 50%;margin-left: -5px;border-width: 5px;border-style: solid;border-color: #555 transparent transparent transparent;} .rl_score_tooltip-bottom { top: 135%; left: 50%; margin-left: -150px; } .rl_score_tooltip-bottom::after { content: ""; position: absolute; bottom: 100%; left: 50%; margin-left: -5px ; border-width: 5px ; border-style: solid; border-color: transparent transparent #555 transparent; }</style>`);try{s=t.local().zoneName}catch(e){console.warn(e)}let e=`<thead><tr><th>Canonical URL (without protocol)</th><th>First Detected</th><th>Cache Refreshed</th></tr></thead><tbody></tbody>`;return e}function i(t,s,i,r,c,l){e&&(e.destroy(),e=null),e=jQuery("#"+t).html(a()).DataTable({processing:!0,serverSide:!0,ajax:{type:"GET",url:r+"api/v1/report/canonical_urls",cache:!0,data:function(e){e.domain=s},dataSrc:function(e){return e.errorMsg?[]:(e.draw=e.data.draw,e.recordsFiltered=e.data.recordsFiltered,e.recordsTotal=e.data.recordsTotal,e.data.records)},beforeSend:function(e){c&&l?(e.setRequestHeader("APIKEY",c),e.setRequestHeader("APISECRET",l)):c&&!l&&c.indexOf(".")&&e.setRequestHeader("Authorization","Bearer "+c)},error:function(e){e&&[401,403].includes(e.status)?alert("Session expired, please login to continue."):e&&[400,404].includes(e.status)?alert("Invalid request."):e&&e.status==503?alert("Service temporary unavailable, please try in some time."):alert(e&&e.responseJSON&&e.responseJSON.message?e.responseJSON.message:"Network error, please try again.")}},columnDefs:[{orderable:!1,aTargets:[0]}],order:[[1,"desc"]],language:{emptyTable:"No canonical URL detected so far. For new site, it may take a few hours depending on the network connectivity and hosting server firewall.",searchPlaceholder:"Type full words to filter..."},dom:'<"datatable-header"fBl><"datatable-scroll-wrap"tr><"datatable-footer"ip>',searchDelay:600,autoWidth:!1,columns:[{data:"url",render:function(e){let r="indexOf";if(e[r]("%3C")>-1||e[r]("%3E")>-1)return e;let a=n(e)?"queued":decodeURI(e);return e&&i&&(a=`<a href="${i.replace("%%URL%%",encodeURIComponent(e))}">${a}</a>`),a}},{data:"create_time",render:function(e){return n(e)?"-":o(e,"This page was first detected at")}},{data:"update_time",render:function(e){return n(e)?"-":o(e,"Cache for this page was last refreshed a")}}]})}return{init:function(e,t,n,s,o,a){i(e,t,n,s,o,a)},initV2:function(e,t,n,s,o){i(e,t,n,s,o,"")}}}()